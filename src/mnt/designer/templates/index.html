<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Gate Layout Designer</title>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <!-- Cytoscape.js -->
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- Include Ace Editor -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"
      crossorigin="anonymous"
    ></script>
    <!-- Custom CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
  </head>
  <body>
    <div class="container my-4">
      <h1 class="mb-4 text-center">Gate Layout Designer</h1>
      <!-- Layout Form -->
      <form id="layout-form" class="row g-3 mb-4 justify-content-center">
        <div class="col-auto">
          <label for="x-dimension" class="visually-hidden">Width (X)</label>
          <input
            type="number"
            id="x-dimension"
            name="x-dimension"
            class="form-control"
            placeholder="Width (X)"
            required
            min="1"
          />
        </div>
        <div class="col-auto">
          <label for="y-dimension" class="visually-hidden">Height (Y)</label>
          <input
            type="number"
            id="y-dimension"
            name="y-dimension"
            class="form-control"
            placeholder="Height (Y)"
            required
            min="1"
          />
        </div>
        <div class="col-auto d-flex align-items-center">
          <button
            type="submit"
            class="btn btn-primary mb-3 me-2"
            id="resize-button"
          >
            Resize Layout
          </button>
          <button
            type="button"
            class="btn btn-secondary mb-3 me-2"
            id="reset-layout-button"
          >
            Reset Layout
          </button>
          <button
            type="button"
            class="btn btn-secondary mb-3"
            id="reset-editor-button"
          >
            Reset Editor
          </button>
        </div>
      </form>
      <!-- Import/Export Buttons -->
      <div class="btn-group mb-3 d-flex justify-content-center" role="group">
        <button
          type="button"
          id="import-verilog-button"
          class="btn btn-outline-primary"
        >
          <i class="fas fa-file-import"></i> Import Verilog
        </button>
        <button
          type="button"
          id="import-button"
          class="btn btn-outline-primary"
        >
          <i class="fas fa-file-import"></i> Import Layout
        </button>
        <button
          type="button"
          id="export-fgl-layout-button"
          class="btn btn-outline-primary"
        >
          <i class="fas fa-file-export"></i> Export Layout
        </button>
        <button
          type="button"
          id="export-qca-layout-button"
          class="btn btn-outline-primary"
        >
          <i class="fas fa-file-export"></i> Export QCA Layout
        </button>
        <button
          type="button"
          id="export-sidb-layout-button"
          class="btn btn-outline-primary"
        >
          <i class="fas fa-file-export"></i> Export hexagonalized SiDB Layout
        </button>
      </div>
      <!-- Hidden File Input for Import -->
      <input
        type="file"
        id="import-file-input"
        accept=".xml"
        style="display: none"
      />
      <input
        type="file"
        id="import-verilog-file-input"
        accept=".v"
        style="display: none"
      />
      <!-- Gate Selection -->
      <div
        id="gate-selection"
        class="btn-group mb-3 d-flex justify-content-center flex-wrap"
        role="group"
      >
        <button
          type="button"
          id="pi-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place a Primary Input gate"
        >
          <i class="fas fa-sign-in-alt"></i> PI
        </button>
        <button
          type="button"
          id="po-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place a Primary Output gate"
        >
          <i class="fas fa-sign-out-alt"></i> PO
        </button>
        <button
          type="button"
          id="inv-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place an Inverter gate"
        >
          <img
            src="../static/gates/INV_DIN.svg"
            alt="BUF Gate"
            width="25"
            height="25"
          />
          INV
        </button>
        <button
          type="button"
          id="buf-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place a Buffer"
        >
          <img
            src="../static/gates/BUF_DIN.svg"
            alt="BUF Gate"
            width="25"
            height="25"
          />
          BUF
        </button>
        <!-- Crossing Top-Bottom Right-Left Gate -->
        <button
          type="button"
          id="bufc-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place a Crossing Top-Bottom Right-Left gate"
        >
          <img
            src="../static/gates/BUFC.svg"
            alt="BUF Gate"
            width="25"
            height="25"
          />
          Crossing
        </button>
        <!-- Crossing Top-Right Left-Bottom Gate -->
        <button
          type="button"
          id="bufk-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place a Crossing Top-Right Left-Bottom gate"
        >
          <img
            src="../static/gates/BUFK.svg"
            alt="BUF Gate"
            width="25"
            height="25"
          />
          Crossing
        </button>
        <button
          type="button"
          id="and-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place an AND gate"
        >
          <img
            src="../static/gates/AND_DIN.svg"
            alt="AND Gate"
            width="25"
            height="25"
          />
          AND
        </button>
        <button
          type="button"
          id="or-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place an OR gate"
        >
          <img
            src="../static/gates/OR_DIN.svg"
            alt="OR Gate"
            width="25"
            height="25"
          />
          OR
        </button>
        <button
          type="button"
          id="nor-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place a NOR gate"
        >
          <img
            src="../static/gates/NOR_DIN.svg"
            alt="NOR Gate"
            width="25"
            height="25"
          />
          NOR
        </button>
        <button
          type="button"
          id="xor-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place an XOR gate"
        >
          <img
            src="../static/gates/XOR_DIN.svg"
            alt="XOR Gate"
            width="25"
            height="25"
          />
          XOR
        </button>
        <button
          type="button"
          id="xnor-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Place an XNOR gate"
        >
          <img
            src="../static/gates/XNOR_DIN.svg"
            alt="XOR Gate"
            width="25"
            height="25"
          />
          XNOR
        </button>
        <button
          type="button"
          id="connect-button"
          class="btn btn-outline-secondary"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Connect gates"
        >
          <i class="fas fa-link"></i> Connect
        </button>
        <button
          type="button"
          id="delete-button"
          class="btn btn-outline-danger"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Delete a gate"
        >
          <i class="fas fa-trash-alt"></i> Delete
        </button>
        <button
          type="button"
          id="cancel-button"
          class="btn btn-outline-warning"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          title="Cancel current action"
        >
          <i class="fas fa-times"></i> Cancel
        </button>
      </div>
      <div class="mb-3 d-flex justify-content-center">
        <!-- ortho Button -->
        <button type="button" id="ortho-button" class="btn btn-outline-primary">
          <i class="fas fa-project-diagram"></i> ortho
        </button>
        <!-- Gold Button -->
        <button
          type="button"
          id="gold-button"
          class="btn btn-outline-primary"
          data-bs-toggle="modal"
          data-bs-target="#goldModal"
        >
          <i class="fas fa-gem"></i> gold
        </button>
        <!-- Gold Algorithm Parameter Modal -->
        <div
          class="modal fade"
          id="goldModal"
          tabindex="-1"
          aria-labelledby="goldModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="goldModalLabel">
                  Specify gold Parameters
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <form id="gold-params-form">
                  <div class="mb-3">
                    <label for="gold-return-first" class="form-label"
                      >Return first found layout</label
                    >
                    <select class="form-select" id="gold-return-first">
                      <option value="false">False</option>
                      <option value="true">True</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="gold-mode" class="form-label"
                      >Effort Mode</label
                    >
                    <select class="form-select" id="gold-mode">
                      <option value="HIGH_EFFORT">HIGH_EFFORT</option>
                      <option value="HIGH_EFFICIENCY">HIGH_EFFICIENCY</option>
                      <option value="HIGHEST_EFFORT">HIGHEST_EFFORT</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="gold-timeout" class="form-label"
                      >Timeout (ms)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="gold-timeout"
                      placeholder="Enter value (1-10000)"
                      min="1"
                      max="10000"
                      value="1000"
                    />
                  </div>
                  <div class="mb-3">
                    <label for="gold-num-vertex-expansions" class="form-label"
                      >Number of Vertex Expansions</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="gold-num-vertex-expansions"
                      placeholder="Enter value (1-100)"
                      min="1"
                      max="10"
                      value="4"
                    />
                  </div>
                  <div class="mb-3">
                    <label for="gold-planar" class="form-label">Planar</label>
                    <select class="form-select" id="gold-planar">
                      <option value="false">False</option>
                      <option value="true">True</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="gold-cost" class="form-label">Cost</label>
                    <select class="form-select" id="gold-cost">
                      <option value="AREA">AREA</option>
                      <option value="WIRES">WIRES</option>
                      <option value="CROSSINGS">CROSSINGS</option>
                      <option value="ACP">ACP</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="gold-enable-multithreading" class="form-label"
                      >Enable Multithreading</label
                    >
                    <select class="form-select" id="gold-enable-multithreading">
                      <option value="false">False</option>
                      <option value="true">True</option>
                    </select>
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
                <button type="button" id="apply-gold" class="btn btn-primary">
                  Apply gold
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- Post-Layout Optimization Button -->
        <button
          type="button"
          id="optimization-button"
          class="btn btn-outline-warning"
          data-bs-toggle="modal"
          data-bs-target="#optimizationModal"
        >
          <i class="fas fa-cogs"></i> Optimize Layout
        </button>
        <!-- Post-Layout Optimization Parameter Modal -->
        <div
          class="modal fade"
          id="optimizationModal"
          tabindex="-1"
          aria-labelledby="optimizationModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="optimizationModalLabel">
                  Specify Optimization Parameters
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <form id="optimization-params-form">
                  <div class="mb-3">
                    <label for="max-gate-relocations" class="form-label"
                      >Max Gate Relocations</label
                    >
                    <select class="form-select" id="max-gate-relocations">
                      <option value="max">Max</option>
                      <option value="custom">Custom</option>
                    </select>
                  </div>
                  <!-- Custom value input, shown only if "Custom" is selected -->
                  <div class="mb-3 d-none" id="custom-relocations-input">
                    <label for="custom-max-gate-relocations" class="form-label"
                      >Enter Custom Number of Relocations</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="custom-max-gate-relocations"
                      placeholder="Enter custom value (0 to max number of tiles)"
                      min="0"
                    />
                  </div>
                  <div class="mb-3">
                    <label for="optimize-pos-only" class="form-label"
                      >Optimize PO Positions Only</label
                    >
                    <select class="form-select" id="optimize-pos-only">
                      <option value="false" selected>False</option>
                      <option value="true">True</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="planar-optimization" class="form-label"
                      >Planar Optimization</label
                    >
                    <select class="form-select" id="planar-optimization">
                      <option value="false" selected>False</option>
                      <option value="true">True</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="optimization-timeout" class="form-label"
                      >Timeout (ms)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="optimization-timeout"
                      placeholder="Enter value (1-10000)"
                      min="1"
                      max="10000"
                      value="1000"
                    />
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
                <button
                  type="button"
                  id="apply-optimization"
                  class="btn btn-primary"
                >
                  Apply Optimization
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- Design Rule Check Button -->
        <button
          type="button"
          id="check-rules-button"
          class="btn btn-outline-success"
        >
          <i class="fas fa-check-circle"></i> Check Design Rules
        </button>
        <!-- Check Equivalence Button -->
        <button
          type="button"
          id="check-equivalence-button"
          class="btn btn-outline-info"
        >
          <i class="fas fa-balance-scale"></i> Check Equivalence
        </button>
      </div>
      <!-- Message Area -->
      <div id="message-area" class="alert alert-info text-center" role="alert">
        Please create a layout to get started.
      </div>
      <div class="zoom-controls d-flex justify-content-center mb-3">
        <button id="zoom-in" class="btn btn-outline-secondary mx-2">
          <i class="fas fa-search-plus"></i> Zoom In
        </button>
        <button id="zoom-out" class="btn btn-outline-secondary mx-2">
          <i class="fas fa-search-minus"></i> Zoom Out
        </button>
        <button id="reset-zoom" class="btn btn-outline-secondary mx-2">
          <i class="fas fa-compress"></i> Reset Zoom
        </button>
      </div>
      <!-- Violations Area with Custom Close Button -->
      <div
        id="violations-area"
        class="alert alert-warning fade show d-none"
        role="alert"
      >
        <button
          type="button"
          class="btn-close close-violations"
          aria-label="Close"
        ></button>
        <h5>Design Rule Violations:</h5>
        <ul id="violations-list"></ul>
      </div>
      <!-- Equivalence Area with Custom Close Button -->
      <div
        id="equivalence-area"
        class="alert alert-warning alert-dismissible fade show d-none"
        role="alert"
      >
        <button
          type="button"
          class="btn-close close-equivalence"
          aria-label="Close"
        ></button>
        <h5>Equivalence:</h5>
        <!-- Dynamic Content Will Be Injected Here -->
      </div>
      <div class="row">
        <div class="col-md-4">
          <!-- Text Editor -->
          <div id="editor-container"></div>
        </div>
        <div class="col-md-8">
          <!-- Cytoscape Container -->
          <div id="cy"></div>
        </div>
      </div>
    </div>
    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap Bundle JS (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom Script -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  </body>
</html>
